{% extends "core/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block contenido %}


<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">

            {% comment %} <div class="alert alert-success" role="alert" id="alertSuccess" style="display: none;">
                El pago se ha realizado con éxito.
            </div>

            <div class="alert alert-danger" role="alert" id="alertFailure" style="display: none;">
                El pago ha fallado. Por favor, inténtelo de nuevo.
            </div>


            <div class="text-center py-3">
                <div id="loader" class="lds-ring" style="margin:auto; display:none;">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div> {% endcomment %}
            

            <div id='paymentInfo'>
                <p>Order Total: ${{ order.get_total }}</p>
                <h4>Select a payment method</h4>
                <div id="paypal-button-container"></div>
            </div>

        </div>
        
    </div>
</div>


<script src="https://www.paypal.com/sdk/js?client-id={{ PAYPAL_CLIENT_ID }}"></script>

    <script>

        paypal.Buttons({
            createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                amount: {
                    value: '0.01'
                }
                }]
            });
            },
            onApprove: function(data, actions) {
              return actions.order.capture().then(function(details){
                setTimeout(function(){
                  window.location.replace("{{ CALLBACK_URL }}")
                }, 3000);
            });
            }
        }).render('#paypal-button-container');
    </script>

{% endblock %}